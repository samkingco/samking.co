@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  @font-face {
    font-family: "CommitMono";
    src: url("/fonts/CommitMono-VariableFont.woff2") format("woff2");
    font-weight: 100 900;
    font-style: normal;
    font-display: block;
  }

  :root {
    --background: 230 4% 100%;
    --foreground: 230 4% 16%;
    --primary: 230 4% 98%;
    --primary-foreground: 230 4% 4%;
    --secondary: 230 4% 80%;
    --secondary-foreground: 230 4% 38%;
    --muted: 230 4% 82%;
    --muted-foreground: 230 4% 60%;
    --border: 230 4% 90%;
  }

  body {
    @apply text-base;
    font-family: "CommitMono", monospace;
    font-variation-settings: "wght" 400;
    font-feature-settings: "ss03", "ss04", "ss05";
  }

  em,
  i {
    font-style: normal;
    font-variation-settings:
      "wght" 400,
      "ital" 1;
  }

  strong,
  b {
    font-weight: normal;
    font-variation-settings: "wght" 700;
  }

  /* Utility for bold with variable font */
  .font-bold {
    font-weight: normal !important;
    font-variation-settings: "wght" 700 !important;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --background: 230 4% 4%;
      --foreground: 230 4% 92%;
      --primary: 230 4% 4%;
      --primary-foreground: 230 4% 94%;
      --secondary: 230 4% 8%;
      --secondary-foreground: 230 4% 80%;
      --muted: 230 4% 12%;
      --muted-foreground: 230 4% 64%;
      --border: 230 4% 12%;
    }

    body {
      -webkit-font-smoothing: antialiased;
    }
  }

  ::selection {
    background: hsl(var(--muted));
    color: hsl(var(--primary-foreground));
  }
}

@layer components {
  /* Markdown content styling */
  .markdown p + p,
  .markdown ul,
  .markdown ul + p,
  .markdown ol,
  .markdown ol + p,
  .markdown blockquote,
  .markdown blockquote + p {
    @apply mt-1lh;
  }

  .markdown h1,
  .markdown h2,
  .markdown h3,
  .markdown h4,
  .markdown h5,
  .markdown h6 {
    @apply font-bold mt-2lh mb-1lh;
  }

  .markdown h1:first-child,
  .markdown h2:first-child,
  .markdown h3:first-child {
    @apply mt-0;
  }

  /* Markdown-style heading prefixes */
  .markdown h1::before {
    content: "# ";
    @apply text-muted-foreground;
  }

  .markdown h2::before {
    content: "## ";
    @apply text-muted-foreground;
  }

  .markdown h3::before {
    content: "### ";
    @apply text-muted-foreground;
  }

  .markdown h4::before {
    content: "#### ";
    @apply text-muted-foreground;
  }

  .markdown h5::before {
    content: "##### ";
    @apply text-muted-foreground;
  }

  .markdown h6::before {
    content: "###### ";
    @apply text-muted-foreground;
  }

  /* Blockquotes with > prefix */
  .markdown blockquote {
    @apply relative pl-[2ch] border-l-0 text-muted-foreground;
  }

  .markdown blockquote::before {
    content: ">";
    @apply absolute left-0 text-muted-foreground;
  }

  .markdown blockquote p + p {
    @apply mt-1lh;
  }

  /* Lists with markdown-style prefixes */
  .markdown ul {
    @apply list-none pl-0;
  }

  .markdown ul li {
    @apply relative pl-[2ch];
  }

  .markdown ul li::before {
    content: "-";
    @apply absolute left-0 text-muted-foreground;
  }

  /* Nested lists */
  .markdown ul ul,
  .markdown ol ul {
    @apply mt-0 ml-[2ch];
  }

  /* Ordered lists */
  .markdown ol {
    @apply list-none pl-0;
    counter-reset: list-counter;
  }

  .markdown ol li {
    @apply relative pl-[3ch];
    counter-increment: list-counter;
  }

  .markdown ol li::before {
    content: counter(list-counter) ".";
    @apply absolute left-0 text-muted-foreground;
  }

  /* Images/figures */
  .markdown figure {
    @apply my-2lh;
  }

  .markdown img {
    @apply max-w-full h-auto;
  }

  .markdown figcaption {
    @apply text-muted-foreground mt-1;
  }

  /* Links */
  .markdown a {
    @apply underline underline-offset-[0.2em] decoration-border text-primary-foreground transition-colors;
  }

  .markdown a:hover {
    @apply decoration-primary-foreground;
  }

  /* Code */
  .markdown code {
    @apply bg-secondary px-0.25 py-0.125 rounded-xs;
  }

  .markdown pre {
    @apply bg-secondary p-1 rounded-sm overflow-x-auto my-1lh;
  }

  .markdown pre code {
    @apply bg-transparent p-0;
  }

  /* Horizontal rules */
  .markdown hr {
    @apply h-px bg-border border-none my-2lh;
  }
}
